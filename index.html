<!DOCTYPE html>
<html lang="id">
<head>
 <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Chat UI</title>
  
  <style>
    html, body {
      height: 100%;
      width: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden; /* Hilangin scroll */
    }
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #1c1a20;
      color: #fff;
      overflow-x: hidden;
      background-attachment: fixed;
    }
    #login {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      width: 100%;
    }
    #chat {
      height: 92vh;
      width: 100vw;
      display: flex;
      flex-direction: column;
      position: relative;
    }
    .toolbar {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: 10px 1px;
      background-color: #101518;
      z-index: 10;
      width: 100%;
    }
    .toolbar.hidden {
      display: none;
    }
    .toolbar svg {
      width: 20px;
      height: 20px;
      fill: white;
      cursor: pointer;
      margin-right: 10px;
    }
    header {
      background-color: #101518;
      padding: 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 100%;
    }
    #messages {
      display: flex;
      flex-direction: column;
      align-items: flex-start; /* default semua pesan ke kiri */
      overflow-y: auto;
      padding: 10px 10px 10px; /* kasih jarak dari atas biar ga ketutup header */
      flex: 1;
      width: 100%;
      box-sizing: border-box;
    }
    .message {
      display: inline-block;
      max-width: 70%;
      margin: 5px;
      padding: 10px;
      border-radius: 8px;
      word-wrap: break-word;
      background-color: #2a3942;
      cursor: pointer;
    }
    .self {
      align-self: flex-end;
      background-color: #005c4b;
    }
    .other {
      align-self: flex-start;
      background-color: #202c33;
    }
    .selected {
      background-color: #004f43 !important;
    }
    .edited-label, .deleted-label {
      font-size: 10px;
      color: #ccc;
      margin-top: 4px;
    }
    #input-area {
      display: flex;
      align-items: center;
      background-color: #202c33;
      padding: 10px;
      width: 100%;
    }
    #input-area input[type="text"] {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 20px;
      margin-right: 10px;
      background-color: #2a3942;
      color: white;
    }
    .circle-button {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background-color: #00a884;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: 5px;
      cursor: pointer;
    }
    
     #input-area {
      display: flex;
      align-items: center;
      background-color: #202c33;
      padding: 10px;
      width: 100%;
    }
    #input-area input[type="text"] {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 20px;
      margin-right: 10px;
      background-color: #2a3942;
      color: white;
    }
    .circle-button {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      border: none;
      background-color: #00a884;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-left: 5px;
      cursor: pointer;
    }
   .modal {
     position: 
     fixed;
     top: 0; 
     left: 0; 
     width: 100%; 
     height: 100%; 
     background: rgba(0,0,0,0.8);
     display: 
     none;
     align-items: 
     center;
     justify-content:
     center;
     z-index: 20; 
     }
    
    .modal-content {
      background: #2a3942;
      padding: 20px; 
      border-radius: 10px; 
      width: 90%; 
      max-width: 800px;
      text-align: center; 
      position: relative;
      }
    .close { 
      position: 
      absolute; 
      top: 10px;
      right: 10px;
      font-size: 24px; 
      cursor: 
      pointer;
      }
     iframe {  
      width: 100%; 
      height: 450px;
      border:
      none;
      }
      
    
      #register { 
      display: flex; 
      flex-direction: column; 
      align-items: center; 
      justify-content: center; 
      height: 100vh; 
      width: 100%; 
      }
      #otpSection { 
      display: 
      none; 
      }
      #chat { 
      display:
      none; 
      } 
      
    
      
      
  </style>

  

</head>
<body>
  
<div id="chat">
  <!-- Kode HTML lu tetep sama -->
  <div id="toolbar" class="toolbar hidden">
    <div onclick="editSelected()">
      <svg viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM21.41 6.34a1.25 1.25 0 000-1.77l-2-2a1.25 1.25 0 00-1.77 0l-1.83 1.83 3.75 3.75 1.85-1.81z"/></svg>
    </div>
    <div onclick="deleteSelected()">
      <svg viewBox="0 0 24 24"><path d="M6 19a2 2 0 002 2h8a2 2 0 002-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
    </div>
    <div onclick="clearSelection()">
      <svg viewBox="0 0 24 24" width="24" height="24" fill="white">
        <circle cx="12" cy="5" r="2"/>
        <circle cx="12" cy="12" r="2"/>
        <circle cx="12" cy="19" r="2"/>
      </svg>
    </div>
  </div>
  <header>
    <div id="chatName">Chat</div>
    <div style="display: flex; gap: 10px;">
   
      
      
      

     <svg viewBox="0 0 24 24" width="24" height="24" fill="white" onclick="openYouTube()"><path d="M21.58 7.2c-.19-1.42-1.4-2.53-2.82-2.68C16.5 4.3 14.25 4.25 12 4.25s-4.5.05-6.76.27c-1.42.15-2.63 1.26-2.82 2.68C2 8.78 2 10.39 2 12s0 3.22.42 4.8c.19 1.42 1.4 2.53 2.82 2.68C7.5 19.7 9.75 19.75 12 19.75s4.5-.05 6.76-.27c1.42-.15 2.63-1.26 2.82-2.68.42-1.58.42-3.19.42-4.8s0-3.22-.42-4.8zM10 15v-6l5 3-5 3z"/></svg>

      <svg viewBox="0 0 24 24" width="24" height="24" fill="white">
        <path d="M6.62 10.79a15.464 15.464 0 006.59 6.59l2.2-2.2a1 1 0 011.11-.21 11.72 11.72 0 004.51.86 1 1 0 011 1v3.5a1 1 0 01-1 1A17 17 0 013 5a1 1 0 011-1h3.5a1 1 0 011 1 11.72 11.72 0 00.86 4.51 1 1 0 01-.21 1.11l-2.53 2.17z"/>
      </svg>
      <svg viewBox="0 0 24 24" width="24" height="24" fill="white">
        <path d="M17 10.5V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-4.5l4 4v-11l-4 4z"/>
      </svg>
      
    </div>
  </header>

  <div id="messages"></div>

  <div id="input-area">
    <textarea id="message" placeholder="Ketik pesan..." rows="1" style="flex: 1; padding: 10px; border: none; border-radius: 20px; background-color: #2a3942; color: white; resize: none;"></textarea>
    <button class="circle-button" onclick="sendMessage()">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="white">
        <path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.59 5.58L20 12l-8-8-8 8z"/>
      </svg>
      
    </button>
    <button class="circle-button" onclick="document.getElementById('imageInput').click()">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="white">
        <path d="M21 19V5a2 2 0 00-2-2H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2zM8.5 13l2.5 3.01L14.5 12l4.5 6H5l3.5-5z"/>
      </svg>
    </button>
    <input type="file" id="imageInput" accept="image/*" style="display:none;" onchange="sendImage(this)">
    <button class="circle-button">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="white">
        <path d="M12 14a3 3 0 003-3V5a3 3 0 00-6 0v6a3 3 0 003 3zm5-3a5 5 0 01-10 0H5a7 7 0 0014 0h-2zM11 18.92V22h2v-3.08A8.003 8.003 0 0020 12h-2a6 6 0 01-12 0H4a8.003 8.003 0 007 6.92z"/>
      </svg>
    </button>
  </div>
</div>




<div id="youtubeModal" class="modal">
    <div class="modal-content">
      <h2>Cari Video YouTube</h2>
      <input type="text" id="youtubeSearch" placeholder="Ketik judul video...">
      <br><br>
      <button onclick="searchYouTube()">Cari</button>
      <p>Hasil akan dibuka di tab baru.</p>
      <div class="close" onclick="closeModal()">&times;</div>
      <iframe id="youtubePlayer" style="display:none;" src="" allow="autoplay; encrypted-media" frameborder="0"></iframe>
    </div>
  </div>
  
  
  
  
  <h2>Buat Akun</h2>
<input type="text" id="usernameInput" placeholder="Masukkan Nama">
<button onclick="buatAkun()">Buat Akun</button>
<p id="pesan"></p>


<script>
  function buatAkun() {
    const username = document.getElementById('usernameInput').value.trim();
    const pesanEl = document.getElementById('pesan');

    if (username === "") {
      pesanEl.textContent = "Nama tidak boleh kosong!";
      return;
    }

    const userRef = firebase.database().ref('users/' + username);

    userRef.once('value').then((snapshot) => {
      if (snapshot.exists()) {
        pesanEl.textContent = "Nama sudah ada, coba nama lain.";
      } else {
        userRef.set({
          dibuat: new Date().toISOString()
        }).then(() => {
          pesanEl.textContent = "Akun berhasil dibuat dengan nama: " + username;
          // kalau mau pindah halaman:
          // window.location.href = "halaman_lain.html";
        });
      }
    });
  }
</script>
  
  
  
  
  
 

  
 
  
  <script>
 function openYouTube() { 
  document.getElementById("youtubeModal").style.display = "flex"; 
  // Pasang langsung video default
  const videoId = "sR4dWHCF-GM"; // Ganti ID video YouTube sesuai kebutuhan
 // https://youtu.be/sR4dWHCF-GM?si=FVw45LVcsE8U86pq
  
  const iframeUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
  document.getElementById("youtubePlayer").src = iframeUrl;
  document.getElementById("youtubePlayer").style.display = "block";
}

function closeModal() { 
  document.getElementById("youtubeModal").style.display = "none"; 
  document.getElementById("youtubePlayer").style.display = "none";
  document.getElementById("youtubePlayer").src = ""; // berhentiin video
}
  </script>



<script>
  const loginDiv = document.getElementById('login');
  const chatDiv = document.getElementById('chat');
  const messagesDiv = document.getElementById('messages');
  const chatName = document.getElementById('chatName');
  const toolbar = document.getElementById('toolbar');
  let selectedMessage = null;
  let currentUser = localStorage.getItem('chatUser');
  let userRole = localStorage.getItem('chatRole');

  function login() {
    const name = document.getElementById('nameInput').value;
    const role = document.getElementById('roleSelect').value;
    if (name) {
      localStorage.setItem('chatUser', name);
      localStorage.setItem('chatRole', role);
      location.reload();
    }
  }

  if (currentUser && userRole) {
    loginDiv.style.display = 'none';
    chatDiv.style.display = 'flex';
    chatName.innerText = currentUser;
  }
  
  function clearSelection() {
    if (selectedMessage) {
      selectedMessage.classList.remove('selected');
      selectedMessage = null;
    }
    toolbar.classList.add('hidden');
  }

  function handleMessageClick(msg, isDeleted) {
    if (isDeleted) return;
    clearSelection();
    selectedMessage = msg;
    msg.classList.add('selected');
    toolbar.classList.remove('hidden');
  }

  function sendMessage() {
    const input = document.getElementById('message');
    const text = input.value.trim();
    if (!text) return;

    const msg = document.createElement('div');
    msg.className = 'message ' + (userRole === 'user1' ? 'self' : 'other');

    const textNode = document.createElement('div');
    textNode.textContent = text;

    const infoNode = document.createElement('div');

    msg.appendChild(textNode);
    msg.appendChild(infoNode);

    msg.addEventListener('contextmenu', e => {
      e.preventDefault();
      handleMessageClick(msg, false);
    });

    messagesDiv.appendChild(msg);
    input.value = '';
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }

  function editSelected() {
    if (!selectedMessage) return;
    const textNode = selectedMessage.children[0];
    const infoNode = selectedMessage.children[1];
    if (textNode.textContent === 'Pesan telah dihapus') return;

    const newText = prompt("Edit pesan:", textNode.textContent);
    if (newText !== null) {
      textNode.textContent = newText;
      infoNode.textContent = 'Pesan diubah';
      infoNode.className = 'edited-label';
    }
    clearSelection();
  }

  function deleteSelected() {
    if (!selectedMessage) return;
    selectedMessage.innerHTML = `<div>Pesan telah dihapus</div>`;
    selectedMessage.classList.remove('selected');
    clearSelection();
  }

  function sendImage(input) {
    const file = input.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = function (e) {
      const msg = document.createElement('div');
      msg.className = 'message ' + (userRole === 'user1' ? 'self' : 'other');

      const img = document.createElement('img');
      img.src = e.target.result;
      img.style.maxWidth = '200px';
      img.style.borderRadius = '8px';

      const infoNode = document.createElement('div');

      msg.appendChild(img);
      msg.appendChild(infoNode);

      msg.addEventListener('contextmenu', e => {
        e.preventDefault();
        handleMessageClick(msg, false);
      });

      messagesDiv.appendChild(msg);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    };
    reader.readAsDataURL(file);
    input.value = '';
  }

  document.addEventListener('click', function (e) {
    if (!e.target.closest('.message') && !e.target.closest('#toolbar')) {
      clearSelection();
    }
  });
</script>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAVtmSFXGMgEO97QwBJFcFip1fXqotFzFI",
    authDomain: "whatsapp-ed801.firebaseapp.com",
    projectId: "whatsapp-ed801",
    storageBucket: "whatsapp-ed801.appspot.com",
    messagingSenderId: "263371978522",
    appId: "1:263371978522:web:679a5a4ca13c9b5fe4dea3",
    measurementId: "G-FJVMZQFBQ2",
    databaseURL: "https://whatsapp-ed801-default-rtdb.asia-southeast1.firebasedatabase.app/"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function sendMessage() {
    const input = document.getElementById('message');
    const text = input.value.trim();
    if (!text) return;

    const newMsg = {
      text: text,
      sender: currentUser,
      role: userRole,
      time: Date.now()
    };

    db.ref("messages").push(newMsg);
    input.value = '';
  }

  db.ref("messages").on("child_added", snapshot => {
    const data = snapshot.val();
    const msg = document.createElement('div');
    msg.className = 'message ' + (data.role === 'user1' ? 'self' : 'other');
    msg.innerHTML = `<div>${data.text}</div><div class="edited-label">${new Date(data.time).toLocaleTimeString()}</div>`;
    msg.addEventListener('contextmenu', e => {
      e.preventDefault();
      handleMessageClick(msg, false);
    });
    messagesDiv.appendChild(msg);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  });
</script>
</body>
</html>